<?xml version='1.0' encoding='UTF-8' ?>
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:f="http://xmlns.jcp.org/jsf/core"
	xmlns:p="http://primefaces.org/ui">
<h:head>
	<title>Ghostnetliste</title>
	<link rel="stylesheet" type="text/css" media="screen" href="styles.css" />
</h:head>
<h:body>
	<h1>Ghostnet auflistung</h1>
	<h:form id="form">
	
		<p:commandButton value="Neues Ghostnet melden"
                 action="ghostnetMelden"
                 icon="pi pi-plus" />
                     
         <br/><br/>
                     
		<p:dataTable value="#{ghostnetListe.liste}" var="ghostnet" lazy="false">
			<f:facet name="header">
				<h2>Ghostnetliste</h2>
			</f:facet>
			 <p:column headerText="Standort (Lat)">
                <p:outputLabel value="#{ghostnet.standort.latitude}" />
            </p:column>

            <p:column headerText="Standort (Lon)">
                <p:outputLabel value="#{ghostnet.standort.longitude}" />
            </p:column>
			 
            <p:column headerText="Größe">
                <p:outputLabel value="#{ghostnet.größe}" />
            </p:column>

            
            <p:column headerText="Status">
                <p:outputLabel value="#{ghostnet.status}" />
            </p:column>

            <p:column headerText="Aktion">
		    <p:commandButton value="Bergung übernehmen"
		                     icon="pi pi-anchor"
		                     update=":bergungsDialogForm"
		                     oncomplete="PF('bergungDialog').show()"
		                     actionListener="#{ghostnetBergung.vorbereitenBergung(ghostnet)}"
		                     disabled="#{ghostnet.bergendePerson != null}" />
			</p:column>
			<p:column headerText="Bergende Person">
			    <h:outputText value="#{ghostnet.bergendePerson != null 
			                           ? ghostnet.bergendePerson.name 
			                           : 'Noch niemand'}" />
			</p:column>

		</p:dataTable>
		
	</h:form>
	
	<h:form id="bergungsDialogForm">
    <p:dialog id="bergungDialog"
              widgetVar="bergungDialog"
              modal="true"
              header="Bergung übernehmen"
              closable="true">

        <h:panelGrid columns="2" cellpadding="5">

            <h:outputLabel for="name" value="Name der bergenden Person:" />
            <h:inputText id="name"
                         value="#{ghostnetBergung.bergendePerson.name}"
                         required="true"
                         requiredMessage="Bitte einen Namen angeben." />

            <h:outputLabel for="handy" value="Handynummer:" />
            <h:inputText id="handy"
                         value="#{ghostnetBergung.bergendePerson.handynummer}" />
        </h:panelGrid>

        <br/>

        <p:commandButton value="Speichern"
                         action="#{ghostnetBergung.bergungSpeichern}"
                         update=":form :bergungsDialogForm"
                         oncomplete="PF('bergungDialog').hide()" />

        <p:commandButton value="Abbrechen"
                         type="button"
                         onclick="PF('bergungDialog').hide()" />

    </p:dialog>
</h:form>

</h:body>
</html>
